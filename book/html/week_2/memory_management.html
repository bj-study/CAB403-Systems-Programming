<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Dynamic Memory Management - CAB403-Systems-Programming</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../preface.html">Preface</a></li><li class="chapter-item expanded "><a href="../.week_1/preface.html"><strong aria-hidden="true">1.</strong> Week 1</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_1/operating-systems.html"><strong aria-hidden="true">1.1.</strong> Operating Systems</a></li><li class="chapter-item expanded "><a href="../week_1/input_and_output.html"><strong aria-hidden="true">1.2.</strong> Input and Output</a></li><li class="chapter-item expanded "><a href="../week_1/pointers.html"><strong aria-hidden="true">1.3.</strong> Pointers</a></li><li class="chapter-item expanded "><a href="../week_1/functions.html"><strong aria-hidden="true">1.4.</strong> Functions</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_2/preface.html"><strong aria-hidden="true">2.</strong> Week 2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_2/operating-system-structures.html"><strong aria-hidden="true">2.1.</strong> Operating System Structures</a></li><li class="chapter-item expanded "><a href="../week_2/arrays.html"><strong aria-hidden="true">2.2.</strong> Arrays</a></li><li class="chapter-item expanded "><a href="../week_2/strings.html"><strong aria-hidden="true">2.3.</strong> Strings</a></li><li class="chapter-item expanded "><a href="../week_2/structures.html"><strong aria-hidden="true">2.4.</strong> Structures</a></li><li class="chapter-item expanded "><a href="../week_2/memory_management.html" class="active"><strong aria-hidden="true">2.5.</strong> Dynamic Memory Management</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_3/preface.html"><strong aria-hidden="true">3.</strong> Week 3</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_3/processes.html"><strong aria-hidden="true">3.1.</strong> Processes</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_4/preface.html"><strong aria-hidden="true">4.</strong> Week 4</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_4/threads.html"><strong aria-hidden="true">4.1.</strong> Threads</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_5/preface.html"><strong aria-hidden="true">5.</strong> Week 5</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_5/synchronisation.html"><strong aria-hidden="true">5.1.</strong> Synchronisation</a></li><li class="chapter-item expanded "><a href="../week_5/synchronisation_examples.html"><strong aria-hidden="true">5.2.</strong> Synchronisation Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_6/preface.html"><strong aria-hidden="true">6.</strong> Week 6</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_6/safety_critical_systems.html"><strong aria-hidden="true">6.1.</strong> Safety Critical Systems</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_7/preface.html"><strong aria-hidden="true">7.</strong> Week 7</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_7/distributed_systems.html"><strong aria-hidden="true">7.1.</strong> Distributed Systems</a></li><li class="chapter-item expanded "><a href="../week_7/sockets.html"><strong aria-hidden="true">7.2.</strong> Sockets</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_8/preface.html"><strong aria-hidden="true">8.</strong> Week 8</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_8/cpu_scheduling.html"><strong aria-hidden="true">8.1.</strong> CPU Scheduling</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_9/preface.html"><strong aria-hidden="true">9.</strong> Week 9</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_9/deadlocks.html"><strong aria-hidden="true">9.1.</strong> Deadlocks</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Week 10</div></li><li class="chapter-item expanded "><a href="../.week_11/preface.html"><strong aria-hidden="true">11.</strong> Week 11</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_11/main-memory.html"><strong aria-hidden="true">11.1.</strong> Main Memory</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_12/preface.html"><strong aria-hidden="true">12.</strong> Week 12</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_12/file-systems.html"><strong aria-hidden="true">12.1.</strong> File Systems</a></li></ol></li><li class="chapter-item expanded "><a href="../.week_13/preface.html"><strong aria-hidden="true">13.</strong> Week 13</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../week_13/virtual-machines.html"><strong aria-hidden="true">13.1.</strong> Virtual Machines</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CAB403-Systems-Programming</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="dynamic-memory-management"><a class="header" href="#dynamic-memory-management">Dynamic Memory Management</a></h1>
<p>Memory in a C program can be divided into four categories:</p>
<ol>
<li>Code memory</li>
<li>Static data memory</li>
<li>Runtime stack memory</li>
<li>Heap memory</li>
</ol>
<h2 id="code-memory"><a class="header" href="#code-memory">Code Memory</a></h2>
<p>Code memory is used to store machine instructions. As a program runs,
machine instructions are read from memory and executed.</p>
<h2 id="static-data-memory"><a class="header" href="#static-data-memory">Static Data Memory</a></h2>
<p>Static data memory is used to store static data. There are two categories of
static data: global and static variables.</p>
<p>Global variables are variables defined outside the scope of any function as 
can be seen in example 1. Static variables on the other hand are defined with
the <code>static</code> modifier as seen in example 2.</p>
<p>Both global and static variables have one value attached to them; they are
assigned memory once; and they are initialised before <code>main</code> begins execution
and will continue to exist until the end of execution.</p>
<p><strong>Example 1: Global variables.</strong></p>
<pre><code class="language-c">int counter = 0;

int increment(void) {
    counter++;

    return counter;
}
</code></pre>
<p><strong>Example 2: Static variables.</strong></p>
<pre><code class="language-c">int increment(void) {
    // will be initialised once
    static int counter = 0;

    // increments every time the function is called
    counter++;

    return counter;
}
</code></pre>
<h2 id="runtime-stack-memory"><a class="header" href="#runtime-stack-memory">Runtime Stack Memory</a></h2>
<p>Runtime stack memory is used by function calls and is FILO (First in, Last out).
When a function is invoked, a block of memory is allocated by the runtime 
stack to store the information about the function call. This block of memory 
is termed as an <em>Activation Record</em>.</p>
<p>The information about the function call includes:</p>
<ul>
<li>Return address.</li>
<li>Internal registers and other machine-specific information.</li>
<li>Parameters.</li>
<li>Local variables.</li>
</ul>
<h2 id="heap-memory"><a class="header" href="#heap-memory">Heap Memory</a></h2>
<p>Heap memory is memory that is allocated during the runtime of the program.
On many systems, the heap is allocated in an opposite direction to the stack
and grows towards the stack as more is allocated. On simple systems without 
memory protection, this can cause the heap and stack to collide if too much
memory is allocated to either one.</p>
<p>To deal with this, C provides two functions in the standard library to handle
dynamic memory allocation; <code>calloc()</code> (contiguous allocation) and <code>malloc()</code>
(memory allocation).</p>
<p><code>void *calloc(size_t n, size_t s)</code> returns a pointer to enough space in memory
to store <code>n</code> objects, each of <code>s</code> bytes. The storage set aside is automatically
initialised to zero.</p>
<p><code>void *malloc(size_t s)</code> returns a pointer to a space of size <code>s</code> and leaves the
memory uninitialised.</p>
<p><strong>Example 3: <code>malloc()</code> and <code>calloc()</code></strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main() {
    int num_of_elements;
    int *ptr;
    int sum = 0;
  
    printf(&quot;Enter number of elements: &quot;);
    scanf(&quot;%d&quot;, &amp;num_of_elements);
  
    ptr = malloc(num_of_elements * sizeof(int));
    // or
    // ptr = calloc(num_of_elements, sizeof(int));
   
    if (ptr == NULL) {
        printf(&quot;[Error] - Memory was unable to be allocated.&quot;);

        exit(0);
    }
  
    printf(&quot;Enter elements: &quot;);

    for (int i = 0; i &lt; n; i++) {
        scanf(&quot;%d&quot;, ptr + i);

        sum += *(ptr + i);
    }
  
    printf(&quot;Sum = %d&quot;, sum);
    
    free(ptr);
  
    return 0;
}
</code></pre>
<h2 id="relevant-links"><a class="header" href="#relevant-links">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/c/memory/malloc">cppreference - malloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/calloc">cppreference - calloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/realloc">cppreference - realloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/free">cppreference - free</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../week_2/structures.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../.week_3/preface.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../week_2/structures.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../.week_3/preface.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
