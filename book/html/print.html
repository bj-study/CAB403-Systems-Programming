<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CAB403-Systems-Programming</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Custom JS scripts for mdbook-pdf PDF generation -->
        <script type='text/javascript'>
            let markAllContentHasLoadedForPrinting = () =>
                window.setTimeout(
                    () => {
                        let p = document.createElement('div');
                        p.setAttribute('id', 'content-has-all-loaded-for-mdbook-pdf-generation');
                        document.body.appendChild(p);
                    }, 100
                );

            window.addEventListener('load', () => {
                // Expand all the <details> elements for printing.
                r = document.getElementsByTagName('details');
                for (let i of r)
                    i.open = true;

                try {
                    MathJax.Hub.Register.StartupHook('End', markAllContentHasLoadedForPrinting);
                } catch (e) {
                    markAllContentHasLoadedForPrinting();
                }
            });
        </script>
    <div style="display: none"><a href="#preface">preface</a><a href="#.week_1-preface">.week_1-preface</a><a href="#week_1-operating-systems">week_1-operating-systems</a><a href="#week_1-input_and_output">week_1-input_and_output</a><a href="#week_1-pointers">week_1-pointers</a><a href="#week_1-functions">week_1-functions</a><a href="#.week_2-preface">.week_2-preface</a><a href="#week_2-operating-system-structures">week_2-operating-system-structures</a><a href="#week_2-arrays">week_2-arrays</a><a href="#week_2-strings">week_2-strings</a><a href="#week_2-structures">week_2-structures</a><a href="#week_2-memory_management">week_2-memory_management</a></div>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="preface.html">Preface</a></li><li class="chapter-item expanded "><a href=".week_1/preface.html"><strong aria-hidden="true">1.</strong> Week 1</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="week_1/operating-systems.html"><strong aria-hidden="true">1.1.</strong> Operating Systems</a></li><li class="chapter-item expanded "><a href="week_1/input_and_output.html"><strong aria-hidden="true">1.2.</strong> Input and Output</a></li><li class="chapter-item expanded "><a href="week_1/pointers.html"><strong aria-hidden="true">1.3.</strong> Pointers</a></li><li class="chapter-item expanded "><a href="week_1/functions.html"><strong aria-hidden="true">1.4.</strong> Functions</a></li></ol></li><li class="chapter-item expanded "><a href=".week_2/preface.html"><strong aria-hidden="true">2.</strong> Week 2</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="week_2/operating-system-structures.html"><strong aria-hidden="true">2.1.</strong> Operating System Structures</a></li><li class="chapter-item expanded "><a href="week_2/arrays.html"><strong aria-hidden="true">2.2.</strong> Arrays</a></li><li class="chapter-item expanded "><a href="week_2/strings.html"><strong aria-hidden="true">2.3.</strong> Strings</a></li><li class="chapter-item expanded "><a href="week_2/structures.html"><strong aria-hidden="true">2.4.</strong> Structures</a></li><li class="chapter-item expanded "><a href="week_2/memory_management.html"><strong aria-hidden="true">2.5.</strong> Dynamic Memory Management</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CAB403-Systems-Programming</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cab403-study-guide--2023-semester-1"><a class="header" href="#cab403-study-guide--2023-semester-1">CAB403 Study Guide | 2023 Semester 1</a></h1>
<p>Timothy Chappell | Notes for CAB403 at the Queensland University of Technology</p>
<h2 id="unit-description"><a class="header" href="#unit-description">Unit Description</a></h2>
<h2 id="disclaimer"><a class="header" href="#disclaimer">Disclaimer</a></h2>
<p>Everything written here is based off the QUT course content. However, there are at times parts of text that are taken from the QUT slides and most of the examples are directly from the course slides (these are referenced when done). This content is designed only for those currently studying an IT degree at QUT, do not share these resources with anyone outside of this community.</p>
<p>If any member of the QUT staff or a representative of such finds any issue with these guides please contact me at jeynesbrook@gmail.com and I will take these down without an argument. The last thing I want to do is cause any issues or damages to the QUT name or QUT resources. I am simply just trying to help students out with presenting the content in an easy to digest manor.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-1"><a class="header" href="#week-1">Week 1</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operating-systems"><a class="header" href="#operating-systems">Operating Systems</a></h1>
<h2 id="what-is-an-operating-system"><a class="header" href="#what-is-an-operating-system">What is an Operating System</a></h2>
<p>An operating system is a program that acts as an intermediary between a user of
a computer and the computer hardware. It's acts as a resource allocator managing 
all resources and decides between conflicting requests for efficient and fair 
resource use. An OS also controls the execution of programs to prevent errors 
and improper use of the computer.</p>
<p>The operating system is responsible for:</p>
<ul>
<li>Executing programs</li>
<li>Make solving user problems easier</li>
<li>Make the computer system convenient to use</li>
<li>Use the computer hardware in an efficient manner</li>
</ul>
<h2 id="computer-system-structure"><a class="header" href="#computer-system-structure">Computer System Structure</a></h2>
<p>Computer systems can be divided into four main components</p>
<ol>
<li><strong>Hardware</strong>: These items provide basic computing resources, i.e. CPU, memory, 
I/O devices.</li>
<li><strong>Operating system</strong>: Controls and coordinates the use of hardware among 
various applications and users.</li>
<li><strong>Application programs</strong>: These items define the ways in which the system
resources are used to solve the computing problems of the use, i.e. word processors,
compilers, web browsers, database systems, video games.</li>
<li><strong>Users</strong>: People, machines, or other computers.</li>
</ol>
<h2 id="computer-startup"><a class="header" href="#computer-startup">Computer Startup</a></h2>
<p>A bootstrap program is loaded at power-up or reboot. This program is typically
stored in ROM or EPROM and is generally know as firmware. This bootstrap program
is responsible for initialising all aspects of the system, loading the operating
system kernal, and starting execution.</p>
<h2 id="computer-system-organisation"><a class="header" href="#computer-system-organisation">Computer System Organisation</a></h2>
<ul>
<li>I/O devices and the CPU can execute concurrently.</li>
<li>Each device controller is in charge of a particular device type and has a local
buffer.</li>
<li>The CPU moves data from/to the main memory to/from local buffers.</li>
<li>I/O is from the device to the local buffer of a particular controller.</li>
<li>The device controller informs the CPU that it has finished its operation by
causing an interrupt.</li>
</ul>
<h2 id="common-functions-of-interrupts"><a class="header" href="#common-functions-of-interrupts">Common Functions of Interrupts</a></h2>
<p>Operating systems are interrupt driven. Interrupts transfer control to the 
interrupt service routine. This generally happens through the interrupt vector 
which contains the addresses of all the service routines. The interrupt architecture 
must save the address of the interrupted instruction.</p>
<p>A trap or exception is a software-generated interrupt caused by either an error
or a user request.</p>
<h2 id="interrupt-handling"><a class="header" href="#interrupt-handling">Interrupt Handling</a></h2>
<p>The operating systems preserves the state of the CPU by storing registers and the
program counter. It then determines which type of interrupt occured, polling or 
vectored interrupt system.</p>
<p>Once determined what caused the interrupt, separate segments of code determine
what action should be taken for each type of interrupt.</p>
<p><img src="week_1/../media/interrupt_timeline.jpg" alt="Figure: Interrupt timeline for a single program doing output." /><br />
<strong>Figure: Interrupt timeline for a single program doing output.</strong></p>
<h2 id="io-structure"><a class="header" href="#io-structure">I/O Structure</a></h2>
<p>There are two ways I/O is usually structured:</p>
<ol>
<li>After I/O starts, control returns to the user program only upon I/O completion.
<ul>
<li>Wait instructions idle the CPU until the next interrupt.</li>
<li>At most, one I/O request is outstanding at a time. This means no simultaneous 
I/O processing.</li>
</ul>
</li>
<li>After I/O starts, control returns to the user program without waiting for I/O 
completion.
<ul>
<li><strong>System call</strong>: Request to the OS to allow users to wait for I/O completion.</li>
<li>A <strong>device-status table</strong> containes entries for each I/O device indicating
its type, address, and state.</li>
<li>The OS indexes into the I/O device table to determine the device status and
to modify a table entry to include an interrupt.</li>
</ul>
</li>
</ol>
<h2 id="storage-definitions-and-notation-review"><a class="header" href="#storage-definitions-and-notation-review">Storage Definitions and Notation Review</a></h2>
<p>The basic unit of computer storage is a bit. A bit contains one of two values,
0 and 1. A byte is 8 bits, and on most computers is the smallest convenient chunck
of storage.</p>
<ul>
<li>A kilobyte, or KB, is \(1,024\) bytes</li>
<li>A megabyte, or MB, is \(1,024^2\) bytes</li>
<li>A gigabyte, or GB, is \(1,024^3\) bytes</li>
<li>A terabyte, or TB, is \(1,024^4\) bytes</li>
<li>A petabyte, or PB, is \(1,024^5\) bytes</li>
</ul>
<h2 id="direct-memory-access-structure"><a class="header" href="#direct-memory-access-structure">Direct Memory Access Structure</a></h2>
<p>This method is used for high-speed I/O devices able to transmit information at
close to memory speeds. Device controllers transfer blocks of data from buffer
storage directly to main memory without CPU intervention. This means only one
interrupt is generated per block rather than the one interrupt per byte.</p>
<h2 id="storage-structure"><a class="header" href="#storage-structure">Storage Structure</a></h2>
<ul>
<li><strong>Main memory</strong>: Only large storage media that the CPU can access directly.
<ul>
<li>Random access</li>
<li>Typically volatile</li>
</ul>
</li>
<li><strong>Secondary storage</strong>: An extension of main memory that provides large non-volatile
storage capacity.</li>
<li><strong>Magnetic discs</strong>: Rigid metal or glass platters covered with magnetic recording
material. The disk surface is logically divided into tracks which are sub-diveded
into sectors. The disk controller determines the logical interaction between the
device and the computer.</li>
<li><strong>Solid-state disks</strong>: Achieves faster speeds than magnetic disks and non-volatile
storage capacity through various technologies.</li>
</ul>
<h2 id="storage-hierarchy"><a class="header" href="#storage-hierarchy">Storage Hierarchy</a></h2>
<p>Storages systems are organised into a hierarchy:</p>
<ul>
<li>Speeds</li>
<li>Cost</li>
<li>Volatility.</li>
</ul>
<p>There is a device driver for each device controller used to manage I/O. They provide
uniform interfaces between controllers and the kernal.</p>
<h2 id="caching"><a class="header" href="#caching">Caching</a></h2>
<p>Caching allows information to be copied into a faster storage system. The main memory
can be viewed as a cache for the secondary storage.</p>
<p>Faster storage (cache) is checked first to determine if the information is there:</p>
<ul>
<li>If so, information is used directly from the cache</li>
<li>If not, data is copied to the cache and used there</li>
</ul>
<p>The cache is usually smaller and more expensive that the storage being cached. 
This means cache management is an important design problem.</p>
<h2 id="computer-system-architecture"><a class="header" href="#computer-system-architecture">Computer-System Architecture</a></h2>
<p>Most systems use a single general-purpose processor. However, most systems have
special-purpose processors as well.</p>
<p>Multi-processor systems, also known as parallel systems or tightly-coupled systems, 
usually come in two types; Asymmetric Multi-processing or Symmetric Multi-processor.
Multi-processor systems have a few advantages over a single general-purpose processor:</p>
<ul>
<li>Increase throughput</li>
<li>Economy of scale</li>
<li>Increased reliability, i.e. graceful degradation or fault tolerance</li>
</ul>
<h2 id="clustered-systems"><a class="header" href="#clustered-systems">Clustered Systems</a></h2>
<p>Clustered systems are like Multi-processor systems, they have multiple systems
working together.</p>
<ul>
<li>These systems typically share storage via a storage-area network (SAN).</li>
<li>Provide a high-availability service which survices failures:
<ul>
<li>Asymmetric clustering have one machine in hot-standby mode.</li>
<li>Symmetric clustering have multiple nodes running applications, monitoring 
each other.</li>
</ul>
</li>
<li>Some clusters are for high-performance computing (HPC). Applications running on 
these clusters must be written to use parallelisation.</li>
<li>Some have a distributed lock manager (DLM) to avoid conflicting operations.</li>
</ul>
<h2 id="operating-system-structure"><a class="header" href="#operating-system-structure">Operating System Structure</a></h2>
<p>Multi-programming organises jobs (code and data) so the CPU always has one to 
execute. This is needed for efficiency as a single user cannot keep a CPU and I/O
devices busy at all times. Multi-programming works by keeping a subset of total
jobs in the system, in memory. One job is selected and run via job scheduling.
When it has to wait (for I/O for example), the OS will switch to another job.</p>
<p>Timesharing is a logical extension in which the CPU switches jobs so frequently
that users can interact with each job while it is running.</p>
<ul>
<li>The response time should be less than one second.</li>
<li>Each user has at least one program executing in memory (process).</li>
<li>If processes don't fit in memory, swapping moves them in and out to run.</li>
<li>Virtual memory allows execution of processes not completely in memory.</li>
<li>If several jobs are ready to run at the same time, the CPU scheduler handles 
which to run.</li>
</ul>
<h2 id="operating-system-operations"><a class="header" href="#operating-system-operations">Operating-System Operations</a></h2>
<p>Dual-mode operations (user mode and kernal mode) allow the OS to protect itself 
and other system components. A mode bit provided by the hardware provides the ability
to distinguish when a system is running user code or kernel code. Some instructions 
are designated as privileged and are only executable in kernal mode. System calls
are used to change the mode to kernal, a return from call resets the mode back to 
user.</p>
<p>Most CPUs also support multi-mode operations, i.e. virtual machine manages (VMM)
mode for guest VMs.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="input-and-output"><a class="header" href="#input-and-output">Input and Output</a></h1>
<h2 id="printf"><a class="header" href="#printf"><code>printf()</code></a></h2>
<p><code>printf()</code> is an output function included in <code>stdio.h</code>. It outputs a character
stream to the standard output file, also known as <code>stdout</code>, which is normally
connected to the screen.</p>
<p>It takes 1 or more arguments with the first being called the control string.</p>
<p>Format specifications can be used to interpolate values within the string. A
format specification is a string that begins with <code>%</code> and ends with a conversion
character. In the above example, the format specifications <code>%s</code> and <code>%d</code> were used. 
Characters in the control string that are not part of a format specification are 
placed directly in the output stream; characters in the control string that are 
format specifications are replaced with the value of the corresponding argument.</p>
<p><strong>Example 1: Output with <code>printf()</code></strong></p>
<pre><code class="language-c">printf(&quot;name: %s, age: %d\n&quot;, &quot;John&quot;, 24); // &quot;name: John, age: 24&quot;
</code></pre>
<h2 id="scanf"><a class="header" href="#scanf"><code>scanf()</code></a></h2>
<p><code>scanf()</code> is an input function included in <code>stdio.h</code>. It reads a series of characters
from the standard input file, also known as <code>stdin</code>, which is normally connected
to the keyboard.</p>
<p>It takes 1 or more arguments with the first being called the control string.</p>
<p><strong>Example 2: Reading input with <code>scanf()</code></strong></p>
<pre><code class="language-c">char a, b, c, s[100];
int n;
double x;

scanf(&quot;%c%c%c%d%s%lf&quot;, &amp;a, &amp;b, &amp;c, &amp;n, n, &amp;x);
</code></pre>
<h2 id="relevant-links"><a class="header" href="#relevant-links">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/c/io/fprintf">cppreference - printf</a></li>
<li><a href="https://en.cppreference.com/w/c/io/fscanf">cppreference - scanf</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pointers"><a class="header" href="#pointers">Pointers</a></h1>
<p>A pointer is a variable used to store a memory address. They can be used to access
memory and manipulate an address.</p>
<p><strong>Example 1: Various ways of declaring a pointer</strong></p>
<pre><code class="language-c">// type *variable;

int *a;
int *b = 0;
int *c = NULL;
int *d = (int *) 1307;

int e = 3;
int *f = &amp;e; // `f` is a pointer to the memory address of `e`
</code></pre>
<p><strong>Example 2: Dereferencing pointers</strong></p>
<pre><code class="language-c">int a = 3;
int *b = &amp;a;

printf(&quot;Values: %d == %d\nAddresses: %p == %p\n&quot;, *b, a, b, &amp;a);
</code></pre>
<h2 id="relevant-links-1"><a class="header" href="#relevant-links-1">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/language/pointer">cppreference - pointer</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="functions"><a class="header" href="#functions">Functions</a></h1>
<p>A function construct in C is used to write code that solves a (small) problem.
A procedural C program is made up of one or more functions, one of them being
<code>main()</code>. A C program will always begin execution with <code>main()</code>.</p>
<p>Function parameters can be passed into a function in one of two ways; pass by value
and pass by reference. When a parameter is passed in via value, the data for the
parameters are copied. This means any changes to said variables within the function
will not affect the original values passed in. Pass by reference on the other hand
passes in the memory address of each variable into the function. This means that
changes to the variables within the function will affect the original variables.</p>
<p><strong>Example 1: Function control</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void prn_message(const int k);

int main(void) {
    int n;

    printf(&quot;There is a message for you.\n&quot;);
    printf(&quot;How many times do you want to see it?\n&quot;);

    scanf(&quot;%d&quot;, &amp;n);

    prn_message(n);

    return 0;
}

void prn_message(const int k) {
    printf(&quot;Here is the message:\n&quot;);

    for (size_t i = 0; i &lt; k; i++) {
        printf(&quot;Have a nice day!\n&quot;);
    }
}
</code></pre>
<p><strong>Example 2: Pass by values</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void swapx(int a, int b);

int main(void) {
    int a = 10;
    int b = 20;

    // Pass by value
    swapx(a, b);

    printf(&quot;within caller - a: %d, b: %b\n&quot;, a, b); // &quot;within caller - a: 10, b: 20&quot;

    return 0;
}

void swapx(int a, int b) {
    int temp;

    temp = a;
    a = b;
    b = temp;

    printf(&quot;within function - a: %d, b: %b\n&quot;, a, b); // &quot;within function - a: 20, b: 10&quot;
}
</code></pre>
<p><strong>Example 3: Pass by value</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void swapx(int *a, int *b);

int main(void) {
    int a = 10;
    int b = 20;

    // Pass by reference
    swapx(&amp;a, &amp;b);

    printf(&quot;within caller - a: %d, b: %b\n&quot;, a, b); // &quot;within caller - a: 20, b: 10&quot;

    return 0;
}

void swapx(int *a, int *b) {
    int temp;

    temp = *a;
    *a = *b;
    *b = temp;

    printf(&quot;within function - a: %d, b: %b\n&quot;, *a, *b); // &quot;within function - a: 20, b: 10&quot;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="week-2"><a class="header" href="#week-2">Week 2</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operating-system-structures"><a class="header" href="#operating-system-structures">Operating System Structures</a></h1>
<h2 id="operating-system-services"><a class="header" href="#operating-system-services">Operating System Services</a></h2>
<p>Operating systems provide an environment for execution of programs and services
to programs and users.</p>
<p>There are many operating system services that provide functions that are
helpful to the user such as:</p>
<ul>
<li><strong>User interface</strong>: Almost all operating systems have a user interface. This can
be in the form of a graphical user interface (GUI) or a command-line (CLI).</li>
<li><strong>Program execution</strong>: The system must be able to load a program into memory
and run that program, end execution, either normally or abnormally.</li>
<li><strong>I/O operations</strong>: A running program may require I/O, which may involve a file
or an I/O device.</li>
<li><strong>File-system manipulation</strong>: The file system is of particular interest. Programs
need to read and write files and directories, create and delete them, search
them, list file information, manage permissions, and more.</li>
<li><strong>Communication</strong>: Processors may exchange information, on the same computer
or between computers over a network.</li>
<li><strong>Error detection</strong>: OS needs to be constantly aware of possible errors:
<ul>
<li>May occur in the CPU and memory hardware, in I/O devices, in user programs,
and more.</li>
<li>For each type of error, the OS should take the appropriate action to ensure
correct and consistent computing.</li>
<li>Debugging facilities can greatly enhance the user's and programmer's abilities
to efficiently use the system.</li>
</ul>
</li>
</ul>
<p>Another set of OS functions exist for ensuring the efficient operation of the
system itself via resource sharing.</p>
<ul>
<li><strong>Resource allocation</strong>: When multiple users or multiple jobs are running
concurrently, resources must be allocated to each of them.</li>
<li><strong>Accounting</strong>: To keep track of which users use how much and what kinds of
resources.</li>
<li><strong>Protection and security</strong>: The owners of information stored in a multi-user
or networked computer system may want to control use of that information. Concurrent
processes should not interfere with each other.
<ul>
<li>Protection involves ensuring that all access to system resources is controlled.</li>
<li>Security of the system from outsiders requires user authentication. This also
extends to defending external I/O devices from invalid access attempts.</li>
<li>If a system is to be protected and secure, pre-cautions must be instituted
throughout it. A chain is only as strong as its weakest link.</li>
</ul>
</li>
</ul>
<h2 id="system-calls"><a class="header" href="#system-calls">System Calls</a></h2>
<p>System calls provide an interface to the services made available by an operating
system. These calls are generally written in higher-level languages such as
C and C++. These system calls however, are mostly accessed by programs via
a high-level application programming interface (API) rather than direct system
call use.</p>
<p>The three most common APIs are Win32 API for Windows, POSIX API for POSIX-based systems,
and JAVA API for the Java virtual machine (JVM)</p>
<p><img src="week_2/../media/standard_api_example.png" alt="Figure: Example of standard api." /></p>
<p>Typically, a number is associated with each system call. The system-call
interface maintains a table indexed according to these numbers. The system call
interface invokes the intended system call in the OS kernel and returns a status
of the systema call and any return values. The caller needs to know nothing about
how the system call is implemented, it just needs to obey the API and understand
what the OS will do as a result call.</p>
<p><img src="week_2/../media/open_system_call_example.png" alt="Figure: The handling of a user application invoking the open() system call." />
<strong>Figure: The handling of a user application invoking the <code>open()</code> system call.</strong></p>
<p>There are many types of system calls:</p>
<ul>
<li>Process control</li>
<li>File management</li>
<li>Device management</li>
<li>Information maintenance</li>
<li>Communications</li>
<li>Protection</li>
</ul>
<p>Often, more information is required than simply the identity of the system call.
There are three general methods used to pass parameters to the OS:</p>
<ol>
<li>Pass parameters into registers. This won't always work however as there may
be more parameters than registers.</li>
<li>Store parameters in a block, or table, in memory, and pass the address of 
the block as a parameter in a register.</li>
<li>Parameters are placed, or pushed, onto the stack by the program and popped
off the stack by the operating system. This method does not limit the number
length of the parameters being passed.</li>
</ol>
<p><img src="week_2/../media/pass_params_as_table.png" alt="Figure: Passing of parameters as a table." />
<strong>Figure: Passing of parameters as a table.</strong></p>
<h2 id="system-programs"><a class="header" href="#system-programs">System Programs</a></h2>
<p>System programs provide a convenient environment for program development and 
execution. They can be generally divided into:</p>
<ul>
<li>File manipulation</li>
<li>Status information sometimes stored in a file modification</li>
<li>Programming language support</li>
<li>Program loading and execution</li>
<li>Communications</li>
<li>Background services</li>
<li>Application programs</li>
</ul>
<h2 id="unix"><a class="header" href="#unix">UNIX</a></h2>
<p>UNIX is limited by hardware functionality. The original UNIX operating system
had limited structing. The UNIX OS consists of two separable parts:</p>
<ol>
<li>Systems programs</li>
<li>The kernel:
<ul>
<li>Consists of everything below the system-call interface and above the
physical hardware.</li>
<li>Provides the file system, CPU scheduling, memory management, and other
operating-system functions.</li>
</ul>
</li>
</ol>
<h2 id="operating-system-structure-1"><a class="header" href="#operating-system-structure-1">Operating System Structure</a></h2>
<p>There are a few ways to organise an operating system.</p>
<h3 id="layered"><a class="header" href="#layered">Layered</a></h3>
<p>The operating system is divided into a number of layers, each built on top
of the lower layers. The bottom layer (layer 0), is the hardware; the highest
is the user interface.</p>
<p>Due to the modularity, layers are selected such that each uses functions and 
services of only lower-level layers.</p>
<p><img src="week_2/../media/layered_os.png" alt="Figure: A layered operating system." />
<strong>Figure: A layered operating system.</strong></p>
<h3 id="microkernel-system"><a class="header" href="#microkernel-system">Microkernel System</a></h3>
<p>In this organisation method, as much as possible is moved from the kernel into 
user space. An example OS that uses a microkernel is Mach, which parts of the
MacOSX kernel (Darwin) is based upon. Communication takes place between user 
modules via message passing.</p>
<div class="table-wrapper"><table><thead><tr><th>Advantages</th><th>Disadvantages</th></tr></thead><tbody>
<tr><td>Easier to extend a microkernel</td><td>Performance overhead of user space to kernel space communication</td></tr>
<tr><td>Easier to port the operating system to new architectures</td><td></td></tr>
<tr><td>More reliable (less code is running in kernel mode)</td><td></td></tr>
<tr><td>More secure</td><td></td></tr>
</tbody></table>
</div>
<p><img src="week_2/../media/microkernel_os.png" alt="Figure: Architecture of a typical microkernel." />
<strong>Figure: Architecture of a typical microkernel.</strong></p>
<h3 id="hybrid-system"><a class="header" href="#hybrid-system">Hybrid System</a></h3>
<p>Most modern operating systems don't use a single model but a use concepts from
a variety. Hybrid systems combine multiple approaches to address performance, security,
and usability needs.</p>
<p>For example, Linux is monolithic, because having the operating system in a 
single address space provides very efficient performance. However, it's also 
modular, so that new functionality can be dynamically added to the kernel.</p>
<h2 id="modules"><a class="header" href="#modules">Modules</a></h2>
<p>Most modern operating systems implement loadable kernel modules (LKMs).
Here, the kernel has a set of core components and can link in additional 
services via modules, either at boot time or during run time</p>
<p>Each core component is separate, can talk to others via known interfaces,
and is loadable as needed within the kernel.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="arrays"><a class="header" href="#arrays">Arrays</a></h1>
<p>An array is a contiguous sequence of data items of the same type.
An array name is an address, or constant pointer value, to the first element 
in said array.</p>
<p>Aggregate operations on an array are not valid in C, this means that you cannot
assign an array to another array. To copy an array you must either copy it component-wise 
(typically via a loop) or via the <code>memcpy()</code> function in <code>string.h</code>.</p>
<p><strong>Example 1: Arrays in practice</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

const int N = 5;

int main(void) {
    // Allocate space for a[0] to a[4]
    int a[N];
    int i;
    int sum = 0;

    // Fill the array
    for (i = 0; i &lt; N; i++) {
        a[i] = 7 + i * i;
    }

    // Print the array
    for (i = 0; i &lt; N; i++) {
        printf(&quot;a[%d] = %d\n&quot;, i, a[i]);
    }

    // Sum the elements
    for (i = 0; i &lt; N; i++) {
        sum += a[i];
    }

    printf(&quot;\nsum = %d\n&quot;, sum);

    return 0;
}
</code></pre>
<p><strong>Example 2: Arrays and Pointers</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

const int N = 5;

int main(void) {
    int a[N];
    int sum;
    int *p;

    // The following two calls are the same
    p = a;
    p = &amp;a[0];

    // The following two calls are the same
    p = a + 1;
    p = &amp;a[1];
    

    // Version 1
    sum = 0;

    for (int i = 0; i &lt; N; i++) {
        sum += a[i];
    }
    
    // Version 2
    sum = 0;

    for (int i = 0; i &lt; N; i++) {
        sum += *(a + i);
    }
}
</code></pre>
<p><strong>Example 3: Bubble Sort</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void swap(int *arr, int i, int j);
void bubble_sort(int *arr, int n);

void main(void) {
    int arr[] = { 5, 1, 4, 2, 8 };
    int N = sizeof(arr) / sizeof(int);

    bubble_sort(arr, N);

    for (int i = 0; i &lt; N; i++) {
        printf(&quot;%d: %d\n&quot;, i, arr[i]);
    }

    return 0;
}

void swap(int *arr, int i, int j) {
    int temp = arr[i];
    arr[i] = arr[j];
    arr[j] = temp;
}

void bubble_sort(int *arr, int n) {
    for (int i = 0; i &lt; n - 1; i++) {
        for (int j = 0; j &lt; n - 1; j++) {
            if (arr[j] &gt; arr[j + 1]) {
                swap(arr, j, j + 1);
            }
        }
    }
}
</code></pre>
<p><strong>Example 4: Copying an Array</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(void) {
    // Copying an array component-wise
    int array_one[5] = { 1, 2, 3, 4, 5 };
    int array_two[5];

    for (int idx = 0; idx &lt; 5; idx++) {
        array_two[idx] = array_one[idx];
    }

    // Copying an array via memcpy
    memcpy(array_two, array_one, sizeof(int) * 5);
}
</code></pre>
<h2 id="relevant-links-2"><a class="header" href="#relevant-links-2">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/container/array">cppreference - array</a></li>
<li><a href="https://en.cppreference.com/w/cpp/string/byte/memcpy">cppreference - memcpy</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="strings"><a class="header" href="#strings">Strings</a></h1>
<p>A string is a one-dimensional array of type <code>char</code>. All strings must end with a
null character <code>\0</code> which is a byte used to represent the end of a string.</p>
<p>A character in a string can
be accessed either by an element in an array of by making use of a pointer.</p>
<p><strong>Example 1: Strings in practice</strong></p>
<pre><code class="language-c">char *first = &quot;john&quot;;
char last[6];

last[0] = 's';
last[1] = 'm';
last[2] = 'i';
last[3] = 't';
last[4] = 'h';
last[5] = '\0';

printf(&quot;Name: %s, len: %lu&quot;, first, strlen(first));
</code></pre>
<h2 id="relevant-links-3"><a class="header" href="#relevant-links-3">Relevant Links</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Null-terminated_string">Wikipedia - Null-terminated string</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="structures"><a class="header" href="#structures">Structures</a></h1>
<p>Structures are named collections of data which are able to be of varying types.</p>
<p><strong>Example 1: Structures in practice</strong></p>
<pre><code class="language-c">struct student {
    char *last_name;
    int student_id;
    char grade;
};

// By using `typedef` we can avoid prefixing the type with `struct`
typedef struct unit {
    char *code;
    char *name;
} unit;

void update_student(struct student *student);
void update_grade(unit *unit);

int main(void) {
    struct student s1 = {
        .last_name = &quot;smith&quot;,
        .student_id = 119493029,
        .grade = 'B',
    };

    s1.grade = 'A';

    update_student(&amp;s1);


    unit new_unit;

    new_unit.name = &quot;Microprocessors and Digital Systems&quot;;

    update_unit(&amp;new_unit);
}

void update_student(struct student *student) {
    // `-&gt;` shorthand for dereference of struct
    student-&gt;last_name = &quot;doe&quot;;
    student-&gt;grade = 'C';
}

void update_unit(unit *unit) {
    // `-&gt;` shorthand for dereference of struct
    unit-&gt;code = &quot;CAB403&quot;;
    unit-&gt;name = &quot;Systems Programming&quot;;
}
</code></pre>
<h2 id="relevant-links-4"><a class="header" href="#relevant-links-4">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/c/language/struct">cppreference - Struct declaration</a></li>
<li><a href="https://en.cppreference.com/w/cpp/language/typedef">cppreference - typedef specifier</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dynamic-memory-management"><a class="header" href="#dynamic-memory-management">Dynamic Memory Management</a></h1>
<p>Memory in a C program can be divided into four categories:</p>
<ol>
<li>Code memory</li>
<li>Static data memory</li>
<li>Runtime stack memory</li>
<li>Heap memory</li>
</ol>
<h2 id="code-memory"><a class="header" href="#code-memory">Code Memory</a></h2>
<p>Code memory is used to store machine instructions. As a program runs,
machine instructions are read from memory and executed.</p>
<h2 id="static-data-memory"><a class="header" href="#static-data-memory">Static Data Memory</a></h2>
<p>Static data memory is used to store static data. There are two categories of
static data: global and static variables.</p>
<p>Global variables are variables defined outside the scope of any function as 
can be seen in example 1. Static variables on the other hand are defined with
the <code>static</code> modifier as seen in example 2.</p>
<p>Both global and static variables have one value attached to them; they are
assigned memory once; and they are initialised before <code>main</code> begins execution
and will continue to exist until the end of execution.</p>
<p><strong>Example 1: Global variables.</strong></p>
<pre><code class="language-c">int counter = 0;

int increment(void) {
    counter++;

    return counter;
}
</code></pre>
<p><strong>Example 2: Static variables.</strong></p>
<pre><code class="language-c">int increment(void) {
    // will be initialised once
    static int counter = 0;

    // increments every time the function is called
    counter++;

    return counter;
}
</code></pre>
<h2 id="runtime-stack-memory"><a class="header" href="#runtime-stack-memory">Runtime Stack Memory</a></h2>
<p>Runtime stack memory is used by function calls and is FILO (First in, Last out).
When a function is invoked, a block of memory is allocated by the runtime 
stack to store the information about the function call. This block of memory 
is termed as an <em>Activation Record</em>.</p>
<p>The information about the function call includes:</p>
<ul>
<li>Return address.</li>
<li>Internal registers and other machine-specific information.</li>
<li>Parameters.</li>
<li>Local variables.</li>
</ul>
<h2 id="heap-memory"><a class="header" href="#heap-memory">Heap Memory</a></h2>
<p>Heap memory is memory that is allocated during the runtime of the program.
On many systems, the heap is allocated in an opposite direction to the stack
and grows towards the stack as more is allocated. On simple systems without 
memory protection, this can cause the heap and stack to collide if too much
memory is allocated to either one.</p>
<p>To deal with this, C provides two functions in the standard library to handle
dynamic memory allocation; <code>calloc()</code> (contiguous allocation) and <code>malloc()</code>
(memory allocation).</p>
<p><code>void *calloc(size_t n, size_t s)</code> returns a pointer to enough space in memory
to store <code>n</code> objects, each of <code>s</code> bytes. The storage set aside is automatically
initialised to zero.</p>
<p><code>void *malloc(size_t s)</code> returns a pointer to a space of size <code>s</code> and leaves the
memory uninitialised.</p>
<p><strong>Example 3: <code>malloc()</code> and <code>calloc()</code></strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main() {
    int num_of_elements;
    int *ptr;
    int sum = 0;
  
    printf(&quot;Enter number of elements: &quot;);
    scanf(&quot;%d&quot;, &amp;num_of_elements);
  
    ptr = malloc(num_of_elements * sizeof(int));
    // or
    // ptr = calloc(num_of_elements, sizeof(int));
   
    if (ptr == NULL) {
        printf(&quot;[Error] - Memory was unable to be allocated.&quot;);

        exit(0);
    }
  
    printf(&quot;Enter elements: &quot;);

    for (int i = 0; i &lt; n; i++) {
        scanf(&quot;%d&quot;, ptr + i);

        sum += *(ptr + i);
    }
  
    printf(&quot;Sum = %d&quot;, sum);
    
    free(ptr);
  
    return 0;
}
</code></pre>
<h2 id="relevant-links-5"><a class="header" href="#relevant-links-5">Relevant Links</a></h2>
<ul>
<li><a href="https://en.cppreference.com/w/c/memory/malloc">cppreference - malloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/calloc">cppreference - calloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/realloc">cppreference - realloc</a></li>
<li><a href="https://en.cppreference.com/w/c/memory/free">cppreference - free</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
